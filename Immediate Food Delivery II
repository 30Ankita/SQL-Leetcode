WITH first AS (
    SELECT MIN(order_date) AS first_order_date, customer_id FROM Delivery
    GROUP BY customer_id
)

SELECT ROUND(IFNULL(100*(
SUM(CASE WHEN Delivery.customer_pref_delivery_date IS NOT NULL THEN 1 ELSE 0 END)/(SELECT COUNT(first.customer_id) FROM first)),0),2) AS immediate_percentage 
FROM first
LEFT JOIN Delivery
ON first.first_order_date = Delivery.customer_pref_delivery_date 
AND first.customer_id = Delivery.customer_id
